pkgname=auth-thu-git
pkgver=20240302.060200
pkgrel=1
pkgdesc="A commandline Tunet (auth4/6.tsinghua.edu.cn, Tsinghua-IPv4) authentication tool"
arch=('x86_64')
url="https://github.com/z4yx/GoAuthing"
license=('GPL3')
makedepends=('go')
source=("git+${url}.git"
	"auth-thu@.service"
	"auth-thu6@.service")
sha256sums=('SKIP'
            'cc8fcf895f7f7b6902a06b2491c36e890daa9cdd544a159709f881ee5346a4b8'
            'e48341c08d99e231863ca8ce455abebf36f180aaccef9b0eecb513d8d0518b2e')

build() {
	cd "GoAuthing"
	CGO_ENABLED=0 go build -ldflags="-s -w" -o auth-thu ./cli
}

package() {
	cd "GoAuthing"
	install -Dm755 "auth-thu" "$pkgdir/usr/bin/auth-thu"
	install -Dm644 "$srcdir/auth-thu@.service" -t "$pkgdir/usr/lib/systemd/system/"
	install -Dm644 "$srcdir/auth-thu6@.service" -t "$pkgdir/usr/lib/systemd/system/"
	install -Dm644 "LICENSE" -t "${pkgdir}/usr/share/licenses/auth-thu/"
}
