pkgname=auth-thu-git
pkgver=20240302.060200
pkgrel=2
pkgdesc="A commandline Tunet (auth4/6.tsinghua.edu.cn, Tsinghua-IPv4) authentication tool"
arch=('x86_64')
url="https://github.com/z4yx/GoAuthing"
license=('GPL-3.0')
makedepends=('go')
source=("git+${url}.git"
	"auth-thu@.service"
	"auth-thu6@.service")
sha256sums=('SKIP'
            '9384e061aa5ae42be7c79fd3c9294532f42d124935f2414759aab54a955cd127'
            '64c2aa4d8f03afd926b6a65ce6d40fc6885ee123a7e23477697f125893865014')

build() {
	cd "GoAuthing"
	CGO_ENABLED=0 go build -ldflags="-s -w" -o auth-thu ./cli
}

package() {
	cd "GoAuthing"
	install -Dm755 "auth-thu" "$pkgdir/usr/bin/auth-thu"
	install -Dm644 "$srcdir/auth-thu@.service" -t "$pkgdir/usr/lib/systemd/system/"
	install -Dm644 "$srcdir/auth-thu6@.service" -t "$pkgdir/usr/lib/systemd/system/"
	install -Dm644 "LICENSE" -t "${pkgdir}/usr/share/licenses/auth-thu/"
}
