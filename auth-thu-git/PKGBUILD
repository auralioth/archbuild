pkgname=auth-thu-git
pkgver=20240302.060200
pkgrel=2
pkgdesc="A commandline Tunet (auth4/6.tsinghua.edu.cn, Tsinghua-IPv4) authentication tool"
arch=('x86_64')
url="https://github.com/z4yx/GoAuthing"
license=('GPL-3.0')
makedepends=('go')
source=("git+${url}.git"
	"auth-thu@.service")
sha256sums=('SKIP'
            '3aaf28e59b0c6be70a6441c413fac041d8925948520c1b9253133458a90910c9')

build() {
	cd "GoAuthing"
	CGO_ENABLED=0 go build -ldflags="-s -w" -o auth-thu ./cli
}

package() {
	cd "GoAuthing"
	install -Dm755 "auth-thu" "$pkgdir/usr/bin/auth-thu"
	install -Dm644 "$srcdir/auth-thu@.service" -t "$pkgdir/usr/lib/systemd/system/"
	install -Dm644 "LICENSE" -t "${pkgdir}/usr/share/licenses/auth-thu/"
}
